<!DOCTYPE html>
<html lang="vi" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CURRY 88</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"/>

    <style>
        /* T√πy ch·ªânh theme m√†u s·∫Øc c·ªßa game */
        :root {
            --primary-color: #c0392b; /* M√†u ƒë·ªè ƒë·∫≠m */
            --secondary-color: #f1c40f; /* M√†u v√†ng */
            --bg-color: #1e3a2a; /* M√†u xanh l√° c√¢y ƒë·∫≠m (m·∫∑t b√†n) */
            --font-color: #ffffff;
            --border-color: #f1c40f;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #111827;
            padding: 1rem;
        }

        /* --- M√†n h√¨nh ƒëƒÉng nh·∫≠p --- */
        #login-screen {
            max-width: 400px;
            text-align: center;
        }
        #login-screen h1 {
            color: var(--secondary-color);
        }

        /* --- B√†n game --- */
        #game-container {
            display: none; /* ·∫®n ban ƒë·∫ßu */
        }

        #game-board {
            background-color: var(--bg-color);
            border: 3px solid var(--border-color);
            border-radius: var(--pico-border-radius);
            padding: 1.5rem;
            width: 100%;
            max-width: 900px;
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
        }

        .header h1 {
            margin: 0;
            color: var(--secondary-color);
            text-shadow: 2px 2px 4px #000;
        }

        /* Th√¥ng tin ng∆∞·ªùi ch∆°i */
        .player-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            margin-bottom: 1rem;
        }
        #player-name, #balance {
            font-size: 1.1em;
            font-weight: bold;
        }

        /* Khu v·ª±c x√∫c x·∫Øc */
        .dice-area { text-align: center; }
        #dice-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 1rem;
        }
        .dice {
            width: 70px;
            height: 70px;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem;
            font-weight: bold;
            background-color: #fff;
            color: #333;
            box-shadow: inset 0 -3px 5px rgba(0,0,0,0.3);
        }
        #result-text {
            font-size: 1.25em;
            font-weight: bold;
            color: var(--secondary-color);
            min-height: 50px; /* Th√™m kh√¥ng gian cho ƒë·ªìng h·ªì ƒë·∫øm ng∆∞·ª£c */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        #countdown-timer {
            font-size: 0.9em;
            color: #ccc;
            margin-top: 5px;
        }
        
        /* Khu v·ª±c ƒë·∫∑t c∆∞·ª£c */
        .betting-area { display: grid; gap: 10px; margin-top: 1.5rem; }
        .bet-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 10px; }
        .bet-option {
            background-color: var(--primary-color);
            border: 2px solid var(--border-color);
            border-radius: var(--pico-border-radius);
            padding: 10px;
            cursor: pointer;
            text-align: center;
            transition: transform 0.2s, filter 0.2s;
            position: relative;
            font-weight: bold;
        }
        .bet-option:not(:disabled):hover {
            transform: scale(1.05);
            filter: brightness(1.2);
        }
        .bet-option .payout { font-size: 0.8em; opacity: 0.8; font-weight: normal; }
        .bet-option .bet-placed-display {
            position: absolute;
            bottom: 2px;
            right: 5px;
            background: var(--secondary-color);
            color: #000;
            font-size: 0.9em;
            padding: 2px 5px;
            border-radius: 5px;
        }

        .grid-col-2 { grid-column: span 2; }
        .grid-col-3 { grid-column: span 3; font-size: 1.5em; padding: 20px 10px; }
        .grid-col-6 { grid-column: span 6; }

        /* Tr·∫°ng th√°i √¥ c∆∞·ª£c */
        .bet-option.selected { filter: brightness(1.3); border-color: #fff; }
        .bet-option.win {
            background-color: #27ae60 !important;
            box-shadow: 0 0 20px #27ae60;
            transform: scale(1.05);
        }
        .bet-option.lose { filter: brightness(0.5); }
        .bet-option:disabled { cursor: not-allowed; filter: grayscale(50%); }

        /* N√∫t ƒëi·ªÅu khi·ªÉn */
        .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1.5rem; }
        .control-btn {
            padding: 12px;
            font-size: 1.1em;
            font-weight: bold;
        }
        #roll-btn { background-color: var(--secondary-color); border-color: var(--secondary-color); color: #000; }
    </style>
</head>
<body>

<main class="container" id="login-screen">
    <article>
        <h1>üé≤ Ch√†o M·ª´ng ƒê·∫øn V·ªõi Game T√†i X·ªâu üé≤</h1>
        <p>Vui l√≤ng nh·∫≠p t√™n c·ªßa b·∫°n ƒë·ªÉ b·∫Øt ƒë·∫ßu.</p>
        <form id="login-form">
            <input type="text" id="username-input" placeholder="T√™n ng∆∞·ªùi ch∆°i" required>
            <button type="submit" id="login-btn">V√†o Game</button>
        </form>
    </article>
</main>

<div id="game-container">
    <article id="game-board">
        <header class="header"><h1>B√†n C∆∞·ª£c T√†i X·ªâu</h1></header>
        
        <div class="player-info">
            <span id="player-name"></span>
            <span id="balance"></span>
        </div>

        <div class="grid">
            <div>
                <label for="bet-amount">M·ª©c c∆∞·ª£c:</label>
                <input type="number" id="bet-amount" value="50" min="1">
            </div>
            <div class="dice-area">
                <div id="dice-container">
                    <div class="dice" id="dice1">?</div>
                    <div class="dice" id="dice2">?</div>
                    <div class="dice" id="dice3">?</div>
                </div>
                <div id="result-text">
                    <span id="result-message">H√£y ƒë·∫∑t c∆∞·ª£c!</span>
                    <div id="countdown-timer"></div>
                </div>
            </div>
        </div>

        <div class="betting-area">
            <div class="bet-grid">
                <button class="bet-option grid-col-3" data-bet-type="xiu">X·ªàU<div class="payout">4-10 (1 ƒÉn 1)</div></button>
                <button class="bet-option grid-col-3" data-bet-type="tai">T√ÄI<div class="payout">11-17 (1 ƒÉn 1)</div></button>
                <button class="bet-option grid-col-3" data-bet-type="le">L·∫∫<div class="payout">1 ƒÉn 1</div></button>
                <button class="bet-option grid-col-3" data-bet-type="chan">CH·∫¥N<div class="payout">1 ƒÉn 1</div></button>
            </div>
            <div class="bet-grid">
                <button class="bet-option" data-bet-type="total_4">4<div class="payout">1:60</div></button>
                <button class="bet-option" data-bet-type="total_5">5<div class="payout">1:30</div></button>
                <button class="bet-option" data-bet-type="total_6">6<div class="payout">1:18</div></button>
                <button class="bet-option" data-bet-type="total_7">7<div class="payout">1:12</div></button>
                <button class="bet-option" data-bet-type="total_8">8<div class="payout">1:8</div></button>
                <button class="bet-option" data-bet-type="total_9">9<div class="payout">1:7</div></button>
                <button class="bet-option" data-bet-type="total_10">10<div class="payout">1:6</div></button>
                <button class="bet-option" data-bet-type="total_11">11<div class="payout">1:6</div></button>
                <button class="bet-option" data-bet-type="total_12">12<div class="payout">1:7</div></button>
                <button class="bet-option" data-bet-type="total_13">13<div class="payout">1:8</div></button>
                <button class="bet-option" data-bet-type="total_14">14<div class="payout">1:12</div></button>
                <button class="bet-option" data-bet-type="total_15">15<div class="payout">1:18</div></button>
                <button class="bet-option" data-bet-type="total_16">16<div class="payout">1:30</div></button>
                <button class="bet-option" data-bet-type="total_17">17<div class="payout">1:60</div></button>
            </div>
            <div class="bet-grid">
                <button class="bet-option" data-bet-type="triple_1">1-1-1<div class="payout">1:180</div></button>
                <button class="bet-option" data-bet-type="triple_2">2-2-2<div class="payout">1:180</div></button>
                <button class="bet-option" data-bet-type="triple_3">3-3-3<div class="payout">1:180</div></button>
                <button class="bet-option" data-bet-type="triple_4">4-4-4<div class="payout">1:180</div></button>
                <button class="bet-option" data-bet-type="triple_5">5-5-5<div class="payout">1:180</div></button>
                <button class="bet-option" data-bet-type="triple_6">6-6-6<div class="payout">1:180</div></button>
                <button class="bet-option grid-col-6" data-bet-type="any_triple">B·ªô Ba B·∫•t K·ª≥<div class="payout">1 ƒÉn 30</div></button>
            </div>
        </div>

        <div class="controls">
            <button id="roll-btn" class="control-btn">L·∫Øc X√∫c X·∫Øc</button>
            <button id="reset-btn" class="control-btn secondary" disabled>C∆∞·ª£c L·∫°i</button>
        </div>
    </article>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // --- Elements ---
    const loginScreen = document.getElementById('login-screen');
    const loginForm = document.getElementById('login-form');
    const usernameInput = document.getElementById('username-input');
    const gameContainer = document.getElementById('game-container');
    const playerNameElem = document.getElementById('player-name');
    const balanceElem = document.getElementById('balance');
    const betAmountInput = document.getElementById('bet-amount');
    const diceElems = [document.getElementById('dice1'), document.getElementById('dice2'), document.getElementById('dice3')];
    const resultMessageElem = document.getElementById('result-message');
    const countdownTimerElem = document.getElementById('countdown-timer');
    const betOptions = document.querySelectorAll('.bet-option');
    const rollBtn = document.getElementById('roll-btn');
    const resetBtn = document.getElementById('reset-btn');

    // --- Game State ---
    let playerName = '';
    let playerBalance = 1000;
    let bets = {};
    let isRoundActive = false;
    let countdownIntervalId = null;

    const PAYOUTS = {
        tai: 1, xiu: 1, chan: 1, le: 1,
        total_4: 60, total_5: 30, total_6: 18, total_7: 12, total_8: 8, total_9: 7, total_10: 6,
        total_11: 6, total_12: 7, total_13: 8, total_14: 12, total_15: 18, total_16: 30, total_17: 60,
        triple_1: 180, triple_2: 180, triple_3: 180, triple_4: 180, triple_5: 180, triple_6: 180,
        any_triple: 30
    };

    // --- Functions ---
    const updateBalance = (amount) => {
        playerBalance = amount;
        balanceElem.textContent = `ƒêi·ªÉm: ${playerBalance}`;
    };
    
    const toggleControls = (active) => {
        isRoundActive = active;
        rollBtn.disabled = active;
        resetBtn.disabled = !active;
        betAmountInput.disabled = active;
        betOptions.forEach(b => b.disabled = active);
    };

    const placeBet = (betType, amount) => {
        if (isRoundActive) return;
        if (amount <= 0) { alert("Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn c∆∞·ª£c h·ª£p l·ªá!"); return; }
        if (amount > playerBalance) { alert("B·∫°n kh√¥ng ƒë·ªß ƒëi·ªÉm ƒë·ªÉ c∆∞·ª£c!"); return; }

        updateBalance(playerBalance - amount);
        bets[betType] = (bets[betType] || 0) + amount;

        const betOptionElem = document.querySelector(`[data-bet-type='${betType}']`);
        betOptionElem.classList.add('selected');
        
        let display = betOptionElem.querySelector('.bet-placed-display');
        if (!display) {
            display = document.createElement('div');
            display.className = 'bet-placed-display';
            betOptionElem.appendChild(display);
        }
        display.textContent = bets[betType];
    };

    const rollDice = () => {
        if (Object.keys(bets).length === 0) {
            alert("Vui l√≤ng ƒë·∫∑t c∆∞·ª£c tr∆∞·ªõc khi l·∫Øc!");
            return;
        }
        toggleControls(true);
        resultMessageElem.textContent = "ƒêang l·∫Øc...";

        let rollCount = 0;
        const rollInterval = setInterval(() => {
            diceElems.forEach(d => d.textContent = Math.floor(Math.random() * 6) + 1);
            if (++rollCount > 20) {
                clearInterval(rollInterval);
                finalizeRoll();
            }
        }, 100);
    };

    const finalizeRoll = () => {
        const dice = [1, 2, 3].map(() => Math.floor(Math.random() * 6) + 1);
        const total = dice.reduce((a, b) => a + b);

        dice.forEach((val, i) => diceElems[i].textContent = val);
        checkWinnings(dice, total);
    };

    const checkWinnings = (dice, total) => {
        const isTriple = dice[0] === dice[1] && dice[1] === dice[2];
        let totalWinnings = 0;

        for (const betType in bets) {
            const betAmount = bets[betType];
            let won = false;
            let payout = PAYOUTS[betType];
            
            if (betType === 'tai' && total >= 11 && total <= 17 && !isTriple) won = true;
            else if (betType === 'xiu' && total >= 4 && total <= 10 && !isTriple) won = true;
            else if (betType === 'chan' && total % 2 === 0 && !isTriple) won = true;
            else if (betType === 'le' && total % 2 !== 0 && !isTriple) won = true;
            else if (betType.startsWith('total_') && parseInt(betType.split('_')[1]) === total) won = true;
            else if (betType === 'any_triple' && isTriple) won = true;
            else if (betType.startsWith('triple_') && isTriple && dice[0] === parseInt(betType.split('_')[1])) won = true;

            const betElem = document.querySelector(`[data-bet-type='${betType}']`);
            if (won) {
                totalWinnings += betAmount + (betAmount * payout);
                betElem.classList.add('win');
            } else {
                betElem.classList.add('lose');
            }
        }

        updateBalance(playerBalance + totalWinnings);
        
        let resultString = `T·ªïng: ${total}. `;
        if (totalWinnings > 0) resultString += `B·∫°n th·∫Øng ${totalWinnings} ƒëi·ªÉm!`;
        else resultString += "R·∫•t ti·∫øc, b·∫°n ƒë√£ thua!";
        
        resultMessageElem.textContent = resultString;
        startNewRoundTimer(5); // B·∫Øt ƒë·∫ßu ƒë·∫øm ng∆∞·ª£c 5s
    };
    
    const startNewRoundTimer = (seconds) => {
        let remaining = seconds;
        countdownTimerElem.textContent = `V√°n m·ªõi sau: ${remaining}s`;

        countdownIntervalId = setInterval(() => {
            remaining--;
            countdownTimerElem.textContent = `V√°n m·ªõi sau: ${remaining}s`;
            if (remaining <= 0) {
                resetBoard();
            }
        }, 1000);
    };

    const resetBoard = () => {
        clearInterval(countdownIntervalId); // D·ª´ng timer n·∫øu ƒëang ch·∫°y
        countdownIntervalId = null;

        bets = {};
        betOptions.forEach(opt => {
            opt.classList.remove('selected', 'win', 'lose');
            const display = opt.querySelector('.bet-placed-display');
            if (display) display.remove();
        });

        diceElems.forEach(d => d.textContent = '?');
        resultMessageElem.textContent = "H√£y ƒë·∫∑t c∆∞·ª£c cho v√°n m·ªõi!";
        countdownTimerElem.textContent = '';
        toggleControls(false);

        if (playerBalance <= 0) {
            alert("B·∫°n ƒë√£ h·∫øt ƒëi·ªÉm! T·∫∑ng b·∫°n 500 ƒëi·ªÉm ƒë·ªÉ ch∆°i ti·∫øp.");
            updateBalance(500);
        }
    };
    
    // --- Login Logic ---
    loginForm.addEventListener('submit', (e) => {
        e.preventDefault();
        playerName = usernameInput.value.trim();
        if(playerName) {
            loginScreen.style.display = 'none';
            gameContainer.style.display = 'block';
            playerNameElem.textContent = `Ng∆∞·ªùi ch∆°i: ${playerName}`;
            updateBalance(1000); // Kh·ªüi t·∫°o ƒëi·ªÉm khi ƒëƒÉng nh·∫≠p
        }
    });

    // --- Event Listeners ---
    betOptions.forEach(option => {
        option.addEventListener('click', () => {
            const betType = option.dataset.betType;
            const amount = parseInt(betAmountInput.value);
            placeBet(betType, amount);
        });
    });

    rollBtn.addEventListener('click', rollDice);
    resetBtn.addEventListener('click', resetBoard);
});
</script>

</body>
</html>

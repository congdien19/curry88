<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Bầu Cua Curry88</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body {
      background-color: #f8f9fa;
      font-family: 'Segoe UI', sans-serif;
    }
    .logo {
      font-size: 2rem;
      font-weight: bold;
      color: #dc3545;
    }
    .bet-options button {
      font-size: 2rem;
      margin: 5px;
      width: 80px;
      height: 80px;
      border-radius: 12px;
      border: 2px solid transparent;
      background-color: white;
    }
    .bet-options button.selected {
      border-color: red;
      background-color: #ffeaea;
    }
    .dice span {
      font-size: 3rem;
      margin: 5px;
    }
    #gameArea {
      display: none;
    }
  </style>
</head>
<body class="text-center p-4">

  <div class="logo mb-4"><i class="bi bi-dice-5-fill"></i> CURRY88</div>

  <!-- AUTH -->
  <div id="authArea" class="card p-4 mx-auto" style="max-width: 400px;">
    <ul class="nav nav-tabs mb-3">
      <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#loginTab">Đăng nhập</a></li>
      <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#registerTab">Đăng ký</a></li>
    </ul>
    <div class="tab-content">
      <div class="tab-pane fade show active" id="loginTab">
        <input type="text" id="loginUser" class="form-control mb-2" placeholder="Tài khoản">
        <input type="password" id="loginPass" class="form-control mb-3" placeholder="Mật khẩu">
        <button class="btn btn-primary w-100" onclick="login()">Đăng nhập</button>
      </div>
      <div class="tab-pane fade" id="registerTab">
        <input type="text" id="registerUser" class="form-control mb-2" placeholder="Tài khoản mới">
        <input type="password" id="registerPass" class="form-control mb-3" placeholder="Mật khẩu">
        <button class="btn btn-success w-100" onclick="register()">Đăng ký</button>
      </div>
    </div>
  </div>

  <!-- GAME -->
  <div id="gameArea">
    <h2 class="mb-3">🎲 Bầu Cua Curry88</h2>
    <p id="welcomeMsg"></p>
    <p>Số dư: <span id="balance">0</span> xu</p>

    <div class="bet-options d-flex justify-content-center flex-wrap mb-3">
      <button onclick="selectBet(this)" data-name="Bầu">🥒</button>
      <button onclick="selectBet(this)" data-name="Cua">🦀</button>
      <button onclick="selectBet(this)" data-name="Tôm">🦐</button>
      <button onclick="selectBet(this)" data-name="Cá">🐟</button>
      <button onclick="selectBet(this)" data-name="Nai">🦌</button>
      <button onclick="selectBet(this)" data-name="Gà">🐓</button>
    </div>

    <div class="mb-3">
      <input type="number" id="betAmount" class="form-control w-50 mx-auto" placeholder="Nhập số xu cược">
    </div>

    <button class="btn btn-danger mb-3" onclick="rollDice()">🎲 Tung xúc xắc</button>
    <div class="dice" id="diceResult"></div>
    <div id="resultMessage" class="fw-bold fs-5 mt-3"></div>
    <button class="btn btn-secondary mt-4" onclick="logout()">🔒 Đăng xuất</button>
  </div>

  <script>
    const emojiMap = {
      "Bầu": "🥒",
      "Cua": "🦀",
      "Tôm": "🦐",
      "Cá": "🐟",
      "Nai": "🦌",
      "Gà": "🐓"
    };

    let users = JSON.parse(localStorage.getItem("users") || "{}");
    let currentUser = localStorage.getItem("currentUser");
    let selectedBet = null;

    function updateBalanceUI() {
      const user = users[currentUser];
      document.getElementById("balance").innerText = user.coins;
      document.getElementById("welcomeMsg").innerText = `Xin chào, ${currentUser}`;
    }

    function showGame() {
      document.getElementById("authArea").style.display = "none";
      document.getElementById("gameArea").style.display = "block";
      updateBalanceUI();
    }

    function register() {
      const u = document.getElementById("registerUser").value.trim();
      const p = document.getElementById("registerPass").value.trim();
      if (!u || !p) return alert("Vui lòng nhập đủ thông tin.");
      if (users[u]) return alert("Tài khoản đã tồn tại!");
      users[u] = { password: p, coins: 5000 };
      localStorage.setItem("users", JSON.stringify(users));
      alert("Đăng ký thành công!");
    }

    function login() {
      const u = document.getElementById("loginUser").value.trim();
      const p = document.getElementById("loginPass").value.trim();
      if (!users[u] || users[u].password !== p) return alert("Sai tài khoản hoặc mật khẩu!");
      currentUser = u;
      localStorage.setItem("currentUser", u);
      showGame();
    }

    function logout() {
      localStorage.removeItem("currentUser");
      location.reload();
    }

    function selectBet(btn) {
      document.querySelectorAll(".bet-options button").forEach(b => b.classList.remove("selected"));
      btn.classList.add("selected");
      selectedBet = btn.getAttribute("data-name");
    }

    function rollDice() {
      const bet = parseInt(document.getElementById("betAmount").value);
      const user = users[currentUser];
      if (!selectedBet) return alert("Chọn 1 con vật để cược!");
      if (!bet || bet <= 0) return alert("Nhập số xu cược hợp lệ!");
      if (bet > user.coins) return alert("Không đủ xu!");

      const animals = Object.keys(emojiMap);
      const results = [];
      let match = 0;
      document.getElementById("diceResult").innerHTML = "";

      for (let i = 0; i < 3; i++) {
        const rand = animals[Math.floor(Math.random() * 6)];
        results.push(rand);
        if (rand === selectedBet) match++;
        const span = document.createElement("span");
        span.textContent = emojiMap[rand];
        document.getElementById("diceResult").appendChild(span);
      }

      if (match > 0) {
        const win = bet * match;
        user.coins += win;
        document.getElementById("resultMessage").innerText = `🎉 Trúng ${match} lần, nhận ${win} xu!`;
      } else {
        user.coins -= bet;
        document.getElementById("resultMessage").innerText = `💥 Không trúng, mất ${bet} xu.`;
      }

      localStorage.setItem("users", JSON.stringify(users));
      updateBalanceUI();
    }

    window.onload = () => {
      if (localStorage.getItem("currentUser")) {
        currentUser = localStorage.getItem("currentUser");
        showGame();
      }
    }
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
